# 📝 VoiceSync 产品需求文档 (PRD)

## 1. 产品概述

**VoiceSync** 是一款专注“语音转文字”跨设备流转的工具。用户在 Android 端利用语音输入法录入文字，系统在感知到输入停止后，**自动发送**至 Mac 剪贴板；并在发送完成且用户无操作后，**自动清空**工作区，为下一次输入做准备。

---

## 2. 核心功能模块

### 2.1 Android 移动端 (发送方)

| 功能点 | 详细描述 | 优先级 |
| --- | --- | --- |
| **全屏输入区** | 极简 `TextArea`，启动即聚焦，方便唤起语音输入法。 | P0 |
| **智能自动发送** | 监测文字变化。若**停止输入达预设秒数**（默认 2s），自动通过 HTTP POST 发送全文。 | P0 |
| **自动清除内容** | 发送成功后，若用户在指定时间内（默认 3s）没有任何操作（无输入、无点击），自动清空输入框。 | P0 |
| **功能配置页** | 允许开关“自动发送”与“自动清除”，并分别设置它们的触发延迟时间。 | P0 |
| **自动发现 (mDNS)** | 自动扫描局域网内广播 `_voicesync._tcp` 的 Mac 设备。 | P0 |
| **手动清除** | 保留显眼的“清除”按钮，作为手动干预的最高优先级操作。 | P0 |

### 2.2 macOS 桌面端 (接收方)

| 功能点 | 详细描述 | 优先级 |
| --- | --- | --- |
| **HTTP 监听服务** | 启动轻量级后台服务，监听特定端口（默认 3000）。 | P0 |
| **剪贴板自动注入** | 接收数据后立即调用 `NSPasteboard` 写入系统剪贴板。 | P0 |
| **mDNS 服务广播** | 启动时通过 Bonjour 协议广播服务，实现“免配置”连接。 | P0 |
| **同步历史记录** | 界面展示同步列表（时间、文本预览），支持二次点击复制。 | P0 |

---

## 3. 核心业务流程

### 3.1 自动化流水线逻辑

[输入] -> [自动发送] -> [自动清除]

1. **输入阶段**：用户语音输入，文字实时显示。每次字符变动都会重置“发送计时器”和“清除计时器”。
2. **发送触发**：用户停止说话，满足“发送延迟”（如 2s）后，内容自动 POST 到 Mac。
3. **清除触发**：

* 发送完成后，系统继续监控。
* 若用户持续处于**无操作状态**（没有新输入，也没有手动点击屏幕），满足“清除延迟”（如 3s）后，输入框内容自动抹除。
* **注意**：如果用户在清空前又开始说话，清除计时器立即销毁，进入下一轮循环。

### 3.2 自动发现流程

1. **Mac 端**：开启 `NetService` 广播。
2. **Android 端**：开启 `NsdManager` 扫描，发现设备后记录其局域网 IP。

---

## 4. 详细逻辑参数 (配置项)

| 参数名 | 默认值 | 范围 | 说明 |
| --- | --- | --- | --- |
| **自动发送延迟** | 2.0s | 1s - 5s | 停止输入到触发网络同步的时间。 |
| **自动清除开关** | 开启 (On) | 开/关 | 是否在同步后自动清空输入框。 |
| **自动清除延迟** | 3.0s | 1s - 10s | 同步成功且无操作后，到清空界面投影的时间。 |

---

## 5. 技术约束与交互规范

### 5.1 数据格式 (JSON)

```json
{
  "content": "刚才说的这段话...",
  "timestamp": 1734656118
}

```

### 5.2 交互细节

* **Android 端**：当自动清除发生时，建议提供一个微弱的视觉反馈（如输入框文字闪烁消失），让用户感知到是系统自动操作而非数据丢失。
* **Mac 端**：接收到新内容时，可以通过系统通知或窗口内的列表闪烁，提示用户“剪贴板已更新”。
