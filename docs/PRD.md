# 📝 VoiceSync 产品需求文档 (PRD)

## 1. 产品概述

**VoiceSync** 是一款专注“语音转文字”跨设备流转的生产力工具。

* **核心场景**：利用手机端优秀的语音输入法（如豆包输入法），将语音快速转化为文字并自动同步到 Mac 剪贴板。
* **设计哲学**：极致自动化。用户只需“说话”，电脑端直接“粘贴”，无需任何手动点击。

---

## 2. 核心功能模块

### 2.1 Android 移动端 (发送方)

| 功能点 | 详细描述 | 优先级 |
| --- | --- | --- |
| **全屏输入区** | 极简 `TextArea`，应用启动即自动聚焦并唤起输入法。 | **P0** |
| **手动 IP 配置** | 提供设置页面，允许用户输入 Mac 端的局域网 IP 地址及端口号（如 `192.168.1.5:3000`）。 | **P0** |
| **智能自动发送** | 监测文字变化。若**停止输入达 2s**（可调），自动通过 HTTP POST 发送全文至 Mac。 | **P0** |
| **自动清除内容** | 发送成功后，若用户在 **3s 内**没有任何操作（无输入、无点击），自动清空工作区。 | **P0** |
| **手动清除** | 保留显眼的“清除”按钮，用于手动干预或紧急重置。 | **P0** |
| **自动发现 (mDNS)** | **后期优化**：自动扫描局域网设备，免去手动输入 IP 的麻烦。 | **P2** |

### 2.2 macOS 桌面端 (接收方)

| 功能点 | 详细描述 | 优先级 |
| --- | --- | --- |
| **HTTP 监听服务** | 启动轻量级后台服务，监听指定端口请求。 | **P0** |
| **剪贴板自动注入** | 接收数据后立即调用系统 API 更新 `NSPasteboard`，实现直接 Command+V。 | **P0** |
| **同步历史记录** | 界面展示同步记录列表，防止后续剪贴板操作覆盖了重要内容。 | **P1** |
| **mDNS 服务广播** | **后期优化**：向局域网广播本设备信息，配合安卓端自动连接。 | **P2** |

---

## 3. 核心业务逻辑

### 3.1 自动化流水线 (Pipeline)

1. **输入监测**：App 实时监听 `onTextChanged` 信号。
2. **发送计时器 (Debounce)**：

* 只要有字符变动，立即重置“发送计时器”。
* 若 2s 内无字符变动，执行网络请求，将内容推送到 Mac。

1. **清除计时器 (Auto-Clear)**：

* 网络请求成功返回后，启动“清除计时器”。
* 若用户持续 3s 无任何交互（屏幕点击或文字输入），清空输入框。
* **异常处理**：若清除倒计时期间用户开始新输入，则立即销毁该计时器，停止清除。

### 3.2 网络连接逻辑 (P0 阶段)

* **物理条件**：双端连接同一 Wi-Fi。
* **配置方式**：用户在 Mac 端查看本机局域网 IP，并在 Android 端设置界面填入。

---

## 4. 详细逻辑参数 (配置项)

| 参数名 | 默认值 | 范围 | 说明 |
| --- | --- | --- | --- |
| **自动发送延迟** | 2.0s | 1s - 5s | 判定用户“说完话”的时间阈值。 |
| **自动清除延迟** | 3.0s | 1s - 10s | 发送成功后保留文字供用户确认的时间。 |
| **目标 IP 地址** | 无 | - | Mac 端在局域网中的具体地址。 |

---

## 5. 技术约束与规范

### 5.1 数据格式 (JSON)

Android 发送给 Mac 的标准格式：

```json
{
  "content": "这是我通过语音同步过来的文字",
  "timestamp": 1734656118
}

```

### 5.2 交互规范

* **Android**：发送成功时，输入框边缘可以有微弱的绿色闪烁提示；自动清空时，文字采用渐隐效果。
* **Mac**：接收成功时，如果 App 窗口不在前台，可以发出轻微的系统提示音或发送一条通知。
